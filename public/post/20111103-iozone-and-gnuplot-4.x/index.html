<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>Iozone and Gnuplot 4.x | Rico&#39;s Blog</title>
<meta name="keywords" content="">
<meta name="description" content="Iozone is a great tool to mesure performance of filesystem. You could find 10 examples here.
In it latest version, 3.97, it came with reporting tools, report.pl and gengnuplot.sh, who use gnuplot to render images. Due to changes in GnuPlot 4.x, report.pl and gnu3d.dem need to be updated to works. Also you may get only 8 metrics in reports instead of 15 expected in latest release of report.pl
gnu3d.dem # # $Id: 3D plot of performance # # Processes files that were created by Generate_Graphs # and displays the results.">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/post/20111103-iozone-and-gnuplot-4.x/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.fc220c15db4aef0318bbf30adc45d33d4d7c88deff3238b23eb255afdc472ca6.css" integrity="sha256-/CIMFdtK7wMYu/MK3EXTPU18iN7/MjiyPrJVr9xHLKY=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/post/20111103-iozone-and-gnuplot-4.x/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="Rico&#39;s Blog (Alt + H)">Rico&#39;s Blog</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      Iozone and Gnuplot 4.x
    </h1>
    <div class="post-meta"><span title='2011-11-03 13:20:23 +0200 +0200'>November 3, 2011</span>

</div>
  </header> 
  <div class="post-content"><p><a href="http://www.iozone.org/">Iozone</a> is a great tool to mesure performance of filesystem. You could find 10 examples <a href="http://www.thegeekstuff.com/2011/05/iozone-examples/">here</a>.</p>
<p>In it latest version, 3.97, it came with reporting tools, <strong>report.pl</strong> and <strong>gengnuplot.sh</strong>, who use gnuplot to render images.
<img loading="lazy" src="2d-recrewrite.png" alt="2d-graph"  />

<img loading="lazy" src="recrewrite.png" alt="3d-graph"  />

Due to changes in GnuPlot 4.x, <strong>report.pl</strong> and <strong>gnu3d.dem</strong> need to be updated to works. Also you may get only <strong>8 metrics</strong> in reports instead of <strong>15</strong> expected in latest release of <strong>report.pl</strong></p>
<h2 id="gnu3ddem">gnu3d.dem<a hidden class="anchor" aria-hidden="true" href="#gnu3ddem">#</a></h2>
<pre tabindex="0"><code>#
# $Id: 3D plot of performance
#
# Processes files that were created by Generate_Graphs
# and displays the results. Also, saves a postscript copy.
#
# Don Capps

set terminal x11
set title &#34;Iozone performance&#34;
set grid lt 2 lw 1
set surface
set parametric
set xtics
set ytics
set logscale x 2
set logscale y 2
set autoscale z
#set xrange [2.**5:2.**24]
set xlabel &#34;File size in 2^n KBytes&#34;
set ylabel &#34;Record size in 2^n Kbytes&#34;
set zlabel &#34;Kbytes/sec&#34;
#set data style lines
set style data lines
set dgrid3d 80,80,3
splot &#39;write/iozone_gen_out.gnuplot&#39; title &#34;Write performance&#34;
pause -1 &#34;Hit return to continue&#34;
set terminal postscript color
set output &#34;write/write.ps&#34;
splot &#39;write/iozone_gen_out.gnuplot&#39; title &#34;Write performance&#34;

set terminal x11
set title &#34;Iozone performance&#34;
set grid lt 2 lw 1
set surface
set xtics
set ytics
set logscale x 2
set logscale y 2
set autoscale z
#set xrange [2.**5:2.**24]
set xlabel &#34;File size in 2^n KBytes&#34;
set ylabel &#34;Record size in 2^n Kbytes&#34;
set zlabel &#34;Kbytes/sec&#34;
#set data style lines
set style data lines
set dgrid3d 80,80,3
splot &#39;rewrite/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;ReWrite performance&#34; with lines
pause -1 &#34;Hit return to continue&#34;
set terminal postscript color
set output &#34;rewrite/rewrite.ps&#34;
splot &#39;rewrite/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;ReWrite performance&#34; with lines

set terminal x11
set title &#34;Iozone performance&#34;
set grid lt 2 lw 1
set surface
set xtics
set ytics
set logscale x 2
set logscale y 2
set autoscale z
#set xrange [2.**5:2.**24]
set xlabel &#34;File size in 2^n KBytes&#34;
set ylabel &#34;Record size in 2^n Kbytes&#34;
set zlabel &#34;Kbytes/sec&#34;
#set data style lines
set style data lines
set dgrid3d 80,80,3
splot &#39;read/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Read performance&#34; with lines
pause -1 &#34;Hit return to continue&#34;
set terminal postscript color
set output &#34;read/read.ps&#34;
splot &#39;read/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Read performance&#34; with lines


set terminal x11
set title &#34;Iozone performance&#34;
set grid lt 2 lw 1
set surface
set xtics
set ytics
set logscale x 2
set logscale y 2
set autoscale z
#set xrange [2.**5:2.**24]
set xlabel &#34;File size in 2^n KBytes&#34;
set ylabel &#34;Record size in 2^n Kbytes&#34;
set zlabel &#34;Kbytes/sec&#34;
#set data style lines
set style data lines
set dgrid3d 80,80,3
splot &#39;reread/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Reread performance&#34; with lines
pause -1 &#34;Hit return to continue&#34;
set terminal postscript color
set output &#34;reread/reread.ps&#34;
splot &#39;reread/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Reread performance&#34; with lines

set terminal x11
set title &#34;Iozone performance&#34;
set grid lt 2 lw 1
set surface
set xtics
set ytics
set logscale x 2
set logscale y 2
set autoscale z
#set xrange [2.**5:2.**24]
set xlabel &#34;File size in 2^n KBytes&#34;
set ylabel &#34;Record size in 2^n Kbytes&#34;
set zlabel &#34;Kbytes/sec&#34;
#set data style lines
set style data lines
set dgrid3d 80,80,3
splot &#39;randread/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Random read performance&#34; with lines
pause -1 &#34;Hit return to continue&#34;
set terminal postscript color
set output &#34;randread/randread.ps&#34;
splot &#39;randread/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Random read performance&#34; with lines

set terminal x11
set title &#34;Iozone performance&#34;
set grid lt 2 lw 1
set surface
set xtics
set ytics
set logscale x 2
set logscale y 2
set autoscale z
#set xrange [2.**5:2.**24]
set xlabel &#34;File size in 2^n KBytes&#34;
set ylabel &#34;Record size in 2^n Kbytes&#34;
set zlabel &#34;Kbytes/sec&#34;
#set data style lines
set style data lines
set dgrid3d 80,80,3
splot &#39;randwrite/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Random write performance&#34; with lines
pause -1 &#34;Hit return to continue&#34;
set terminal postscript color
set output &#34;randwrite/randwrite.ps&#34;
splot &#39;randwrite/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Random write performance&#34; with lines

set terminal x11
set title &#34;Iozone performance&#34;
set grid lt 2 lw 1
set surface
set xtics
set ytics
set logscale x 2
set logscale y 2
set autoscale z
#set xrange [2.**5:2.**24]
set xlabel &#34;File size in 2^n KBytes&#34;
set ylabel &#34;Record size in 2^n Kbytes&#34;
set zlabel &#34;Kbytes/sec&#34;
#set data style lines
set style data lines
set dgrid3d 80,80,3
splot &#39;bkwdread/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Read Backwards performance&#34; with lines
pause -1 &#34;Hit return to continue&#34;
set terminal postscript color
set output &#34;bkwdread/bkwdread.ps&#34;
splot &#39;bkwdread/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Read Backwards performance&#34; with lines

set terminal x11
set title &#34;Iozone performance&#34;
set grid lt 2 lw 1
set surface
set xtics
set ytics
set logscale x 2
set logscale y 2
set autoscale z
#set xrange [2.**5:2.**24]
set xlabel &#34;File size in 2^n KBytes&#34;
set ylabel &#34;Record size in 2^n Kbytes&#34;
set zlabel &#34;Kbytes/sec&#34;
#set data style lines
set style data lines
set dgrid3d 80,80,3
splot &#39;recrewrite/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Record rewrite performance&#34; with lines
pause -1 &#34;Hit return to continue&#34;
set terminal postscript color
set output &#34;recrewrite/recrewrite.ps&#34;
splot &#39;recrewrite/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Record rewrite performance&#34; with lines

set terminal x11
set title &#34;Iozone performance&#34;
set grid lt 2 lw 1
set surface
set xtics
set ytics
set logscale x 2
set logscale y 2
set autoscale z
#set xrange [2.**5:2.**24]
set xlabel &#34;File size in 2^n KBytes&#34;
set ylabel &#34;Record size in 2^n Kbytes&#34;
set zlabel &#34;Kbytes/sec&#34;
#set data style lines
set style data lines
set dgrid3d 80,80,3
splot &#39;strideread/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Stride read performance&#34; with lines
pause -1 &#34;Hit return to continue&#34;
set terminal postscript color
set output &#34;strideread/strideread.ps&#34;
splot &#39;strideread/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Stride read performance&#34; with lines

set terminal x11
set title &#34;Iozone performance&#34;
set grid lt 2 lw 1
set surface
set xtics
set ytics
set logscale x 2
set logscale y 2
set autoscale z
#set xrange [2.**5:2.**24]
set xlabel &#34;File size in 2^n KBytes&#34;
set ylabel &#34;Record size in 2^n Kbytes&#34;
set zlabel &#34;Kbytes/sec&#34;
#set data style lines
set style data lines
set dgrid3d 80,80,3
splot &#39;fwrite/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Fwrite performance&#34; with lines
pause -1 &#34;Hit return to continue&#34;
set terminal postscript color
set output &#34;fwrite/fwrite.ps&#34;
splot &#39;fwrite/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Fwrite performance&#34; with lines

set terminal x11
set title &#34;Iozone performance&#34;
set grid lt 2 lw 1
set surface
set xtics
set ytics
set logscale x 2
set logscale y 2
set autoscale z
#set xrange [2.**5:2.**24]
set xlabel &#34;File size in 2^n KBytes&#34;
set ylabel &#34;Record size in 2^n Kbytes&#34;
set zlabel &#34;Kbytes/sec&#34;
#set data style lines
set style data lines
set dgrid3d 80,80,3
splot &#39;frewrite/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Frewrite performance&#34; with lines
pause -1 &#34;Hit return to continue&#34;
set terminal postscript color
set output &#34;frewrite/frewrite.ps&#34;
splot &#39;frewrite/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Frewrite performance&#34; with lines

set terminal x11
set title &#34;Iozone performance&#34;
set grid lt 2 lw 1
set surface
set xtics
set ytics
set logscale x 2
set logscale y 2
set autoscale z
#set xrange [2.**5:2.**24]
set xlabel &#34;File size in 2^n KBytes&#34;
set ylabel &#34;Record size in 2^n Kbytes&#34;
set zlabel &#34;Kbytes/sec&#34;
#set data style lines
set style data lines
set dgrid3d 80,80,3
splot &#39;fread/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Fread performance&#34; with lines
pause -1 &#34;Hit return to continue&#34;
set terminal postscript color
set output &#34;fread/fread.ps&#34;
splot &#39;fread/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Fread performance&#34; with lines

set terminal x11
set title &#34;Iozone performance&#34;
set grid lt 2 lw 1
set surface
set xtics
set ytics
set logscale x 2
set logscale y 2
set autoscale z
#set xrange [2.**5:2.**24]
set xlabel &#34;File size in 2^n KBytes&#34;
set ylabel &#34;Record size in 2^n Kbytes&#34;
set zlabel &#34;Kbytes/sec&#34;
#set data style lines
set style data lines
set dgrid3d 80,80,3
splot &#39;freread/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Freread performance&#34; with lines
pause -1 &#34;Hit return to exit&#34;
set terminal postscript color
set output &#34;freread/freread.ps&#34;
splot &#39;freread/iozone_gen_out.gnuplot&#39; using 1:2:3 title &#34;Freread performance&#34; with lines
</code></pre><h2 id="reportpl">report.pl<a hidden class="anchor" aria-hidden="true" href="#reportpl">#</a></h2>
<pre tabindex="0"><code>#!/usr/bin/perl
#
# arguments: one of more report files
#
# Christian Mautner &lt;christian * mautner . ca&gt;, 2005-10-31
#
# This script is based loosely on the Generate_Graph set
# of scripts that come with iozone, but is a complete re-write
#
# The main reason to write this was the need to compare the behaviour of
# two or more different setups, for tuning filesystems or 
# comparing different pieces of hardware.
#
# This script is in the public domain, too short and too trivial
# to deserve a copyright.
#
# Simply run iozone like, for example, ./iozone -a -g 4G &gt; config1.out (if your machine has 4GB)
# and then run perl report.pl config1.out
# or get another report from another box into config2.out and run
# perl report.pl config1.out config2.out
# the look in the report_* directory for .png
#
# If you don&#39;t like png or the graphic size, search for &#34;set terminal&#34; in this file and put whatever gnuplot
# terminal you want. Note I&#39;ve also noticed that gnuplot switched the set terminal png syntax
# a while back, you might need &#34;set terminal png small size 900,700&#34;
#


@Reports=@ARGV;

die &#34;usage: $0 &lt;iozone.out&gt; [&lt;iozone2.out&gt;...]\n&#34; if not @Reports or grep (m|^-|, @Reports);

die &#34;report files must be in current directory&#34; if grep (m|/|, @Reports);

%columns=(
         &#39;write&#39;     =&gt;3,
         &#39;read&#39;      =&gt;5,
         &#39;rewrite&#39;   =&gt;4,
         &#39;reread&#39;    =&gt;6,
         &#39;randread&#39;  =&gt;7,
         &#39;randwrite&#39; =&gt;8,
         &#39;bkwdread&#39;  =&gt;9,
         &#39;recrewrite&#39;=&gt;10,
         &#39;strideread&#39;=&gt;11,
         &#39;fwrite&#39;    =&gt;12,
         &#39;frewrite&#39;  =&gt;13,
         &#39;fread&#39;     =&gt;14,
         &#39;freread&#39;   =&gt;15,
         );

#
# create output directory. the name is the concatenation
# of all report file names (minus the file extension, plus
# prefix report_)
#
$outdir=&#34;report_&#34;.join(&#34;_&#34;,map{/([^\.]+)(\..*)?/ &amp;&amp; $1}(@Reports));

print STDERR &#34;Output directory: $outdir &#34;;

if ( -d $outdir )
{
    print STDERR &#34;(removing old directory) &#34;;
    system &#34;rm -rf $outdir&#34;;
}

mkdir $outdir or die &#34;cannot make directory $outdir&#34;;

print STDERR &#34;done.\nPreparing data files...&#34;;

foreach $report (@Reports)
{
    open(I, $report) or die &#34;cannot open $report for reading&#34;;
    $report=~/^([^\.]+)/;
    $datafile=&#34;$1.dat&#34;;
    push @datafiles, $datafile;
    open(O, &#34;&gt;$outdir/$datafile&#34;) or die &#34;cannot open $outdir/$datafile for writing&#34;;
    open(O2, &#34;&gt;$outdir/2d-$datafile&#34;) or die &#34;cannot open $outdir/$datafile for writing&#34;;
    while(&lt;I&gt;)
    {
        next unless ( /^[\s\d]+$/ );
        @split = split();
        # We may have only 7 metrics (no block entries). Replaced == 15 with &gt;=8
        next unless ( @split &gt;= 8 );
        print O;
        print O2 if $split[1] == 16384 or $split[0] == $split[1];
    }
    close I, O, O2;
}

print STDERR &#34;done.\nGenerating graphs:&#34;;

foreach $column (keys %columns)
{
    print STDERR &#34; $column&#34;;

    open(G, &#34;&gt;$outdir/$column.do&#34;) or die &#34;cannot open $outdir/$column.do for writing&#34;;
    print G qq{
set title &#34;Iozone performance: $column&#34;
set grid lt 2 lw 1
set surface
set parametric
set xtics
set ytics
set logscale x 2
set logscale y 2
set autoscale z
#set xrange [2.**5:2.**24]
set xlabel &#34;File size in KBytes&#34;
set ylabel &#34;Record size in Kbytes&#34;
set zlabel &#34;Kbytes/sec&#34;
#set data style lines
set style data lines
set dgrid3d 80,80,3
#set terminal png small picsize 900 700
set terminal png small size 900 700
set output &#34;$column.png&#34;
};

    print G &#34;splot &#34;. join(&#34;, &#34;, map{qq{&#34;$_&#34; using 1:2:$columns{$column} title &#34;$_&#34;}}(@datafiles));

    print G &#34;\n&#34;;

    close G;

    open(G, &#34;&gt;$outdir/2d-$column.do&#34;) or die &#34;cannot open $outdir/$column.do for writing&#34;;
    print G qq{
set title &#34;Iozone performance: $column&#34;
#set terminal png small picsize 450 350
set terminal png small size 450 350
set logscale x
set xlabel &#34;File size in KBytes&#34;
set ylabel &#34;Kbytes/sec&#34;
set output &#34;2d-$column.png&#34;
};

    print G &#34;plot &#34;. join(&#34;, &#34;, map{qq{&#34;2d-$_&#34; using 1:$columns{$column} title &#34;$_&#34; with lines}}(@datafiles));

    print G &#34;\n&#34;;

    close G;

    if ( system(&#34;cd $outdir &amp;&amp; gnuplot $column.do &amp;&amp; gnuplot 2d-$column.do&#34;) )
    {
        print STDERR &#34;(failed) &#34;;
    }
    else
    {
        print STDERR &#34;(ok) &#34;;
    }
}

print STDERR &#34;done.\n&#34;;
</code></pre>

  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2024 <a href="http://localhost:1313/">Rico&#39;s Blog</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
